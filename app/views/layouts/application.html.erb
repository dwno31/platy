<!DOCTYPE html>
<html>
  <head>
    <title>Platy</title>
    <%= csrf_meta_tags %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <script src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
    <script>
        function getCookie(cname) {
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for(var i = 0; i <ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }
      //에러이미지 서버 호출-인코딩
      function imgError(image,type,id) {
          image.onerror = "";
          $.ajax({
            url:"/img_reproduce",
            data:{type:type, id:id},
            method:"POST",
            success:function(data){
                image.src=data.url;
            }
          });
          return true;
      };
      //구글어낼러틱스 호출
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-96186716-1', 'auto');
      ga('send', 'pageview');
    //address-bar hide

    //샵 선택시 모달 팝업 및 모달 히스토리 설정
    function shop_product_popup(id){
        var id = id;
        window.history.pushState("","","");
        $(".shop-product-popup").load("/shop_product/"+id,function(id){
            $(".shop-product-popup").modal('show');
        });
    }

    function product_rcmd_popup(id){
        var id = id;
        window.history.pushState("","","");
        $(".shop-product-popup").load("/product_rcmd/"+id,function(id){
            $(".shop-product-popup").modal('show');
        });
    }

    function item_filter_popup(){
           $(".filter-popup").modal('show');
    }

    function item_search_toggle(data){
        if(data){
        $(".notibar").load("/search_toggle/?toggle=1");
        }
        else{
        $(".contents-frame").fadeOut(300).load("/section/product",function(){}).fadeIn(300);
        }
    }
    function item_search(){

    }

    function login_popup(){
        $(".modal").modal('hide')
        $(".login-modal").modal('show');
    }

    function userlike(click,type,id){
        $("div[name=likeitem"+id+"]").toggleClass('likebutton-'+type+'-clicked');
//        $(".userlike_parent"+click+">")
        var type=type;
        var id = id;
        $.ajax({
            url:'/userlike/'+type+'/'+id,
            data:{type:type, id:id},
            method:'POST',
            success:function(){
            },
            error:function(){
                $("div[name=likeitem"+id+"]").toggleClass('likebutton-'+type+'-clicked');
                login_popup();
            }
        })

    }
      function tag_toggle(a){
          $(".tag-button").not(a).removeClass("tag-button-clicked");
          $(a).toggleClass("tag-button-clicked");


      }



    </script>
  </head>

  <body>
    <%= yield %>
  </body>
<script>
    $(".modal-product-item>a").on("click",function(){
        document.cookie = "intro_switch=false";
        console.log("a clicked");
        window.history.pushState({},"lastscroll","");
    });

    $('.modal').on('show.bs.modal', function(e) {
        window.location.hash = "modal";
    });
    $('.modal').on('hide.bs.modal',function(e){
        window.location.hash = "";
    });
    $(window).on('hashchange', function (event) {
        if(window.location.hash != "#modal") {
            $('.modal').modal('hide');
        }
    });
</script>
</html>
